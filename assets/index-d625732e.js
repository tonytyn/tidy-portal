import{d as x}from"./request-c09486d7.js";import{b as e,A as oe,d as N,r as _,a as n,o as w,i as R,w as a,e as H,f as y,m as U,j as J,c as L,F as T,k as B,u as E,S as se,t as q,l as P,_ as ue}from"./index-17f23244.js";import{s as Q,U as re}from"./index-d258ee4d.js";var de={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};const ce=de;function G(t){for(var l=1;l<arguments.length;l++){var s=arguments[l]!=null?Object(arguments[l]):{},o=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(s).filter(function(c){return Object.getOwnPropertyDescriptor(s,c).enumerable}))),o.forEach(function(c){ie(t,c,s[c])})}return t}function ie(t,l,s){return l in t?Object.defineProperty(t,l,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[l]=s,t}var j=function(l,s){var o=G({},l,s.attrs);return e(oe,G({},o,{icon:ce}),null)};j.displayName="ReloadOutlined";j.inheritAttrs=!1;const pe=j,me=t=>x.get("/user/list?username="+t.username+"&pageNum="+t.pageNum+"&pageSize="+t.pageSize),W=t=>x.get("/user/detail?id="+t),X=t=>x.get("/user/roles?id="+t),_e=t=>x.post("/user/create",t),ve=t=>x.delete("/user/delete?id="+t),fe=(t,l)=>x.put("/user/roles?id="+t,l),be=t=>x.put("/user/update",t),ge={style:{"text-align":"center"}},he=N({__name:"CreateUser",props:{modalVisible:Boolean},emits:["modalClose"],setup(t,{emit:l}){const s=_(),o=_({username:"",account:"",password:"",phone:""}),c=async()=>{const{data:b}=await _e(o.value);if(b.code!==0)return U.error(b.msg);U.success(b.msg),s.value.resetFields(),l("modalClose")},u=()=>{l("modalClose")};return(b,m)=>{const h=n("a-input"),v=n("a-form-item"),f=n("a-input-password"),r=n("a-button"),i=n("a-form"),g=n("a-modal");return w(),R(g,{open:t.modalVisible,title:"创建用户",onCancel:u,footer:null},{default:a(()=>[e(i,{ref_key:"formRef",ref:s,model:o.value,"label-col":{span:5},"wrapper-col":{span:15}},{default:a(()=>[e(v,{label:"用户名",name:"username"},{default:a(()=>[e(h,{value:o.value.username,"onUpdate:value":m[0]||(m[0]=d=>o.value.username=d)},null,8,["value"])]),_:1}),e(v,{label:"账号",name:"account"},{default:a(()=>[e(h,{value:o.value.account,"onUpdate:value":m[1]||(m[1]=d=>o.value.account=d)},null,8,["value"])]),_:1}),e(v,{label:"密码",name:"password"},{default:a(()=>[e(f,{value:o.value.password,"onUpdate:value":m[2]||(m[2]=d=>o.value.password=d)},null,8,["value"])]),_:1}),e(v,{label:"手机号",name:"phone"},{default:a(()=>[e(h,{value:o.value.phone,"onUpdate:value":m[3]||(m[3]=d=>o.value.phone=d)},null,8,["value"])]),_:1}),H("div",ge,[e(r,{type:"primary",onClick:c},{default:a(()=>[y("提交")]),_:1})])]),_:1},8,["model"])]),_:1},8,["open"])}}}),Ce=N({__name:"UserDetail",props:{modalVisible:Boolean,userId:Number},emits:["modalClose"],setup(t,{emit:l}){const s=t,o=_({id:0,username:"",account:"",phone:"",state:"",createdAt:""}),c=_([]),u=_([]);J(s,async()=>{if(s.modalVisible){const{data:m}=await W(s.userId);o.value=m.data;const{data:h}=await Q();u.value=[],h.data.forEach(f=>{u.value.push({label:f.roleName,value:f.id,disabled:!0})});const{data:v}=await X(s.userId);c.value=v.data}});const b=()=>{l("modalClose")};return(m,h)=>{const v=n("a-input"),f=n("a-form-item"),r=n("a-checkbox-group"),i=n("a-switch"),g=n("a-form"),d=n("a-modal");return w(),R(d,{open:t.modalVisible,title:"用户详情",onCancel:b,footer:null},{default:a(()=>[e(g,{ref:"formRef",model:o.value,"label-col":{span:5},"wrapper-col":{span:15}},{default:a(()=>[e(f,{label:"用户名",name:"username"},{default:a(()=>[e(v,{value:o.value.username,disabled:""},null,8,["value"])]),_:1}),e(f,{label:"账号",name:"account"},{default:a(()=>[e(v,{value:o.value.account,disabled:""},null,8,["value"])]),_:1}),e(f,{label:"手机号",name:"phone"},{default:a(()=>[e(v,{value:o.value.phone,disabled:""},null,8,["value"])]),_:1}),e(f,{label:"角色"},{default:a(()=>[e(r,{value:c.value,"onUpdate:value":h[0]||(h[0]=I=>c.value=I),options:u.value},null,8,["value","options"])]),_:1}),e(f,{label:"状态",name:"state"},{default:a(()=>[e(i,{checked:o.value.state==="启用",disabled:""},null,8,["checked"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])}}}),ye={style:{"text-align":"center"}},ke=N({__name:"EditUser",props:{modalVisible:Boolean,userId:Number},emits:["modalClose"],setup(t,{emit:l}){const s=t,o=_(),c=_({id:0,username:"",account:"",state:"",phone:"",createdAt:""}),u=_({id:0,username:"",account:"",state:"",phone:""}),b=_([]),m=_([]);J(s,async()=>{if(s.modalVisible){const{data:r}=await W(s.userId);c.value=r.data,u.value.username=r.data.username,u.value.account=r.data.account,u.value.phone=r.data.phone,u.value.state=r.data.state;const{data:i}=await Q();m.value=[],i.data.forEach(d=>{m.value.push({label:d.roleName,value:d.id,disabled:!1})});const{data:g}=await X(s.userId);b.value=g.data}});const h=async()=>{const{data:r}=await fe(s.userId,b.value);if(r.code!==0)return U.error(r.msg);U.success(r.msg)},v=async()=>{const{data:r}=await be(u.value);if(r.code!==0)return U.error(r.msg);U.success(r.msg),o.value.resetFields(),l("modalClose")},f=()=>{l("modalClose")};return(r,i)=>{const g=n("a-input"),d=n("a-form-item"),I=n("a-checkbox-group"),O=n("a-switch"),z=n("a-button"),M=n("a-form"),$=n("a-modal");return w(),R($,{open:t.modalVisible,title:"用户详情",onCancel:f,footer:null},{default:a(()=>[e(M,{ref_key:"formRef",ref:o,model:c.value,"label-col":{span:5},"wrapper-col":{span:15}},{default:a(()=>[e(d,{label:"用户名",name:"username"},{default:a(()=>[e(g,{value:u.value.username,"onUpdate:value":i[0]||(i[0]=p=>u.value.username=p)},null,8,["value"])]),_:1}),e(d,{label:"账号",name:"account"},{default:a(()=>[e(g,{value:c.value.account,disabled:""},null,8,["value"])]),_:1}),e(d,{label:"手机号",name:"phone"},{default:a(()=>[e(g,{value:u.value.phone,"onUpdate:value":i[1]||(i[1]=p=>u.value.phone=p)},null,8,["value"])]),_:1}),e(d,{label:"角色"},{default:a(()=>[e(I,{value:b.value,"onUpdate:value":i[2]||(i[2]=p=>b.value=p),options:m.value,onChange:h},null,8,["value","options"])]),_:1}),e(d,{label:"状态",name:"state"},{default:a(()=>[e(O,{checked:u.value.state,"onUpdate:checked":i[3]||(i[3]=p=>u.value.state=p),checkedValue:"启用",unCheckedValue:"停用"},null,8,["checked"])]),_:1}),H("div",ye,[e(z,{type:"primary",onClick:v},{default:a(()=>[y("提交")]),_:1})])]),_:1},8,["model"])]),_:1},8,["open"])}}}),we={name:"User"},Ue=N({...we,setup(t){const l=_({username:"",pageNum:1,pageSize:10}),s=_([]),o=[{key:"index",title:"序号",width:80,align:"center"},{title:"用户名",dataIndex:"username",align:"center"},{title:"账号",dataIndex:"account",align:"center"},{key:"state",title:"状态",dataIndex:"state",align:"center"},{key:"createdAt",title:"创建日期",dataIndex:"createdAt",align:"center"},{key:"operation",title:"操作",align:"center"}],c=_(0),u=async()=>{const{data:p}=await me(l.value);s.value=p.data.list,c.value=p.data.total},b=()=>`共 ${c.value} 条`,m=(p,C)=>{console.log(p,"查询数据，更新table数据",C)},h=()=>{l.value.username="",l.value.pageNum=1,l.value.pageSize=10,u()},v=_(!1),f=()=>{v.value=!0},r=()=>{v.value=!1},i=_(0),g=_(!1),d=p=>{i.value=p,g.value=!0},I=()=>{g.value=!1},O=_(!1),z=p=>{i.value=p,O.value=!0},M=()=>{O.value=!1},$=async p=>{const{data:C}=await ve(p);U.success(C.msg)};return u(),(p,C)=>{const Y=n("a-input"),S=n("a-form-item"),V=n("a-button"),Z=n("a-form"),K=n("a-divider"),ee=n("a-tag"),ae=n("a-popconfirm"),te=n("a-space"),le=n("a-table"),ne=n("a-pagination");return w(),L(T,null,[e(Z,{layout:"inline",model:l.value},{default:a(()=>[e(S,{label:"用户名"},{default:a(()=>[e(Y,{value:l.value.username,"onUpdate:value":C[0]||(C[0]=k=>l.value.username=k)},null,8,["value"])]),_:1}),e(S,null,{default:a(()=>[e(V,{type:"primary",icon:B(E(se)),onClick:u},{default:a(()=>[y(" 查询 ")]),_:1},8,["icon"])]),_:1}),e(S,null,{default:a(()=>[e(V,{icon:B(E(pe)),onClick:h},{default:a(()=>[y(" 重置 ")]),_:1},8,["icon"])]),_:1}),e(S,null,{default:a(()=>[e(V,{icon:B(E(re)),onClick:f},{default:a(()=>[y(" 创建 ")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),e(K),e(le,{columns:o,"data-source":s.value,pagination:!1,rowKey:"id",bordered:""},{bodyCell:a(({index:k,record:A,column:D})=>[D.key==="index"?(w(),L(T,{key:0},[y(q(k+1),1)],64)):P("",!0),D.key==="state"?(w(),R(ee,{key:1,color:A.state==="启用"?"success":"error"},{default:a(()=>[y(q(A.state),1)]),_:2},1032,["color"])):P("",!0),D.key==="operation"?(w(),R(te,{key:2},{default:a(()=>[e(V,{type:"primary",size:"small",onClick:F=>d(A.id)},{default:a(()=>[y("详情")]),_:2},1032,["onClick"]),e(V,{type:"primary",size:"small",onClick:F=>z(A.id)},{default:a(()=>[y("编辑")]),_:2},1032,["onClick"]),e(ae,{title:"确定要删除这个账号吗？","ok-text":"是的","cancel-text":"我再想想",onConfirm:F=>$(A.id)},{default:a(()=>[e(V,{type:"primary",size:"small"},{default:a(()=>[y("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)):P("",!0)]),_:1},8,["data-source"]),e(ne,{current:l.value.pageNum,"onUpdate:current":C[1]||(C[1]=k=>l.value.pageNum=k),"page-size":l.value.pageSize,"onUpdate:pageSize":C[2]||(C[2]=k=>l.value.pageSize=k),total:c.value,"onUpdate:total":C[3]||(C[3]=k=>c.value=k),"show-total":b,"show-size-changer":"",onChange:m,class:"pagination"},null,8,["current","page-size","total"]),e(he,{modalVisible:v.value,onModalClose:r},null,8,["modalVisible"]),e(Ce,{modalVisible:g.value,userId:i.value,onModalClose:I},null,8,["modalVisible","userId"]),e(ke,{modalVisible:O.value,userId:i.value,onModalClose:M},null,8,["modalVisible","userId"])],64)}}});const Oe=ue(Ue,[["__scopeId","data-v-f4d42aaa"]]);export{Oe as default};
