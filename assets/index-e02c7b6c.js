import{d as S}from"./request-2ab48660.js";import{b as e,A as Q,S as re,d as N,r as p,a as s,o as U,h as A,w as n,g as W,f as w,m as x,i as X,c as T,F as q,j as D,u as j,t as G,k as B,_ as ce}from"./index-2fbd72ca.js";import{s as Y,U as ie}from"./index-4e528a42.js";var de={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"};const me=de;function H(a){for(var t=1;t<arguments.length;t++){var l=arguments[t]!=null?Object(arguments[t]):{},u=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(l).filter(function(o){return Object.getOwnPropertyDescriptor(l,o).enumerable}))),u.forEach(function(o){pe(a,o,l[o])})}return a}function pe(a,t,l){return t in a?Object.defineProperty(a,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[t]=l,a}var E=function(t,l){var u=H({},t,l.attrs);return e(Q,H({},u,{icon:me}),null)};E.displayName="ReloadOutlined";E.inheritAttrs=!1;const _e=E;function J(a){for(var t=1;t<arguments.length;t++){var l=arguments[t]!=null?Object(arguments[t]):{},u=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(l).filter(function(o){return Object.getOwnPropertyDescriptor(l,o).enumerable}))),u.forEach(function(o){fe(a,o,l[o])})}return a}function fe(a,t,l){return t in a?Object.defineProperty(a,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):a[t]=l,a}var F=function(t,l){var u=J({},t,l.attrs);return e(Q,J({},u,{icon:re}),null)};F.displayName="SearchOutlined";F.inheritAttrs=!1;const ve=F,be=a=>S.get("/user/list?username="+a.username+"&pageNum="+a.pageNum+"&pageSize="+a.pageSize),Z=a=>S.get("/user/detail?id="+a),K=a=>S.get("/user/roles?id="+a),ge=a=>S.post("/user/create",a),he=a=>S.delete("/user/delete?id="+a),ye=(a,t)=>S.put("/user/roles?id="+a,t),Ce=a=>S.put("/user/update",a),we={style:{"text-align":"center"}},ke=N({__name:"CreateUser",props:{modalVisible:Boolean},emits:["modalClose"],setup(a,{emit:t}){const l=t,u=p(),o=p({username:"",account:"",password:"",phone:""}),c=async()=>{const{data:h}=await ge(o.value);if(h.code!==0)return x.error(h.msg);x.success(h.msg),u.value.resetFields(),l("modalClose")},C=()=>{l("modalClose")};return(h,_)=>{const v=s("a-input"),f=s("a-form-item"),b=s("a-input-password"),r=s("a-button"),m=s("a-form"),y=s("a-modal");return U(),A(y,{open:a.modalVisible,title:"创建用户",onCancel:C,footer:null},{default:n(()=>[e(m,{ref_key:"formRef",ref:u,model:o.value,"label-col":{span:5},"wrapper-col":{span:15}},{default:n(()=>[e(f,{label:"用户名",name:"username"},{default:n(()=>[e(v,{value:o.value.username,"onUpdate:value":_[0]||(_[0]=i=>o.value.username=i)},null,8,["value"])]),_:1}),e(f,{label:"账号",name:"account"},{default:n(()=>[e(v,{value:o.value.account,"onUpdate:value":_[1]||(_[1]=i=>o.value.account=i)},null,8,["value"])]),_:1}),e(f,{label:"密码",name:"password"},{default:n(()=>[e(b,{value:o.value.password,"onUpdate:value":_[2]||(_[2]=i=>o.value.password=i)},null,8,["value"])]),_:1}),e(f,{label:"手机号",name:"phone"},{default:n(()=>[e(v,{value:o.value.phone,"onUpdate:value":_[3]||(_[3]=i=>o.value.phone=i)},null,8,["value"])]),_:1}),W("div",we,[e(r,{type:"primary",onClick:c},{default:n(()=>[w("提交")]),_:1})])]),_:1},8,["model"])]),_:1},8,["open"])}}}),Oe=N({__name:"UserDetail",props:{modalVisible:Boolean,userId:Number},emits:["modalClose"],setup(a,{emit:t}){const l=a,u=p({id:0,username:"",account:"",phone:"",state:"",createdAt:""}),o=p([]),c=p([]);X(l,async()=>{if(l.modalVisible){const{data:_}=await Z(l.userId);u.value=_.data;const{data:v}=await Y();c.value=[],v.data.forEach(b=>{c.value.push({label:b.roleName,value:b.id,disabled:!0})});const{data:f}=await K(l.userId);o.value=f.data}});const C=t,h=()=>{C("modalClose")};return(_,v)=>{const f=s("a-input"),b=s("a-form-item"),r=s("a-checkbox-group"),m=s("a-switch"),y=s("a-form"),i=s("a-modal");return U(),A(i,{open:a.modalVisible,title:"用户详情",onCancel:h,footer:null},{default:n(()=>[e(y,{ref:"formRef",model:u.value,"label-col":{span:5},"wrapper-col":{span:15}},{default:n(()=>[e(b,{label:"用户名",name:"username"},{default:n(()=>[e(f,{value:u.value.username,disabled:""},null,8,["value"])]),_:1}),e(b,{label:"账号",name:"account"},{default:n(()=>[e(f,{value:u.value.account,disabled:""},null,8,["value"])]),_:1}),e(b,{label:"手机号",name:"phone"},{default:n(()=>[e(f,{value:u.value.phone,disabled:""},null,8,["value"])]),_:1}),e(b,{label:"角色"},{default:n(()=>[e(r,{value:o.value,"onUpdate:value":v[0]||(v[0]=O=>o.value=O),options:c.value},null,8,["value","options"])]),_:1}),e(b,{label:"状态",name:"state"},{default:n(()=>[e(m,{checked:u.value.state==="启用",disabled:""},null,8,["checked"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])}}}),Ue={style:{"text-align":"center"}},xe=N({__name:"EditUser",props:{modalVisible:Boolean,userId:Number},emits:["modalClose"],setup(a,{emit:t}){const l=a,u=p(),o=p({id:0,username:"",account:"",state:"",phone:"",createdAt:""}),c=p({id:0,username:"",account:"",state:"",phone:""}),C=p([]),h=p([]);X(l,async()=>{if(l.modalVisible){const{data:r}=await Z(l.userId);o.value=r.data,c.value.username=r.data.username,c.value.account=r.data.account,c.value.phone=r.data.phone,c.value.state=r.data.state;const{data:m}=await Y();h.value=[],m.data.forEach(i=>{h.value.push({label:i.roleName,value:i.id,disabled:!1})});const{data:y}=await K(l.userId);C.value=y.data}});const _=async()=>{const{data:r}=await ye(l.userId,C.value);if(r.code!==0)return x.error(r.msg);x.success(r.msg)},v=async()=>{const{data:r}=await Ce(c.value);if(r.code!==0)return x.error(r.msg);x.success(r.msg),u.value.resetFields(),f("modalClose")},f=t,b=()=>{f("modalClose")};return(r,m)=>{const y=s("a-input"),i=s("a-form-item"),O=s("a-checkbox-group"),z=s("a-switch"),$=s("a-button"),P=s("a-form"),g=s("a-modal");return U(),A(g,{open:a.modalVisible,title:"用户详情",onCancel:b,footer:null},{default:n(()=>[e(P,{ref_key:"formRef",ref:u,model:o.value,"label-col":{span:5},"wrapper-col":{span:15}},{default:n(()=>[e(i,{label:"用户名",name:"username"},{default:n(()=>[e(y,{value:c.value.username,"onUpdate:value":m[0]||(m[0]=d=>c.value.username=d)},null,8,["value"])]),_:1}),e(i,{label:"账号",name:"account"},{default:n(()=>[e(y,{value:o.value.account,disabled:""},null,8,["value"])]),_:1}),e(i,{label:"手机号",name:"phone"},{default:n(()=>[e(y,{value:c.value.phone,"onUpdate:value":m[1]||(m[1]=d=>c.value.phone=d)},null,8,["value"])]),_:1}),e(i,{label:"角色"},{default:n(()=>[e(O,{value:C.value,"onUpdate:value":m[2]||(m[2]=d=>C.value=d),options:h.value,onChange:_},null,8,["value","options"])]),_:1}),e(i,{label:"状态",name:"state"},{default:n(()=>[e(z,{checked:c.value.state,"onUpdate:checked":m[3]||(m[3]=d=>c.value.state=d),checkedValue:"启用",unCheckedValue:"停用"},null,8,["checked"])]),_:1}),W("div",Ue,[e($,{type:"primary",onClick:v},{default:n(()=>[w("提交")]),_:1})])]),_:1},8,["model"])]),_:1},8,["open"])}}}),Se={name:"User"},Ve=N({...Se,setup(a){const t=p({username:"",pageNum:1,pageSize:10}),l=p([]),u=[{key:"index",title:"序号",width:80,align:"center"},{title:"用户名",dataIndex:"username",align:"center"},{title:"账号",dataIndex:"account",align:"center"},{key:"state",title:"状态",dataIndex:"state",align:"center"},{key:"createdAt",title:"创建日期",dataIndex:"createdAt",align:"center"},{key:"operation",title:"操作",align:"center"}],o=p(0),c=async()=>{const{data:g}=await be(t.value);l.value=g.data.list,o.value=g.data.total},C=()=>`共 ${o.value} 条`,h=(g,d)=>{console.log(g,"查询数据，更新table数据",d)},_=()=>{t.value.username="",t.value.pageNum=1,t.value.pageSize=10,c()},v=p(!1),f=()=>{v.value=!0},b=()=>{v.value=!1},r=p(0),m=p(!1),y=g=>{r.value=g,m.value=!0},i=()=>{m.value=!1},O=p(!1),z=g=>{r.value=g,O.value=!0},$=()=>{O.value=!1},P=async g=>{const{data:d}=await he(g);x.success(d.msg)};return c(),(g,d)=>{const ee=s("a-input"),R=s("a-form-item"),V=s("a-button"),ae=s("a-form"),te=s("a-divider"),ne=s("a-tag"),le=s("a-popconfirm"),oe=s("a-space"),se=s("a-table"),ue=s("a-pagination");return U(),T(q,null,[e(ae,{layout:"inline",model:t.value},{default:n(()=>[e(R,{label:"用户名"},{default:n(()=>[e(ee,{value:t.value.username,"onUpdate:value":d[0]||(d[0]=k=>t.value.username=k)},null,8,["value"])]),_:1}),e(R,null,{default:n(()=>[e(V,{type:"primary",icon:D(j(ve)),onClick:c},{default:n(()=>[w(" 查询 ")]),_:1},8,["icon"])]),_:1}),e(R,null,{default:n(()=>[e(V,{icon:D(j(_e)),onClick:_},{default:n(()=>[w(" 重置 ")]),_:1},8,["icon"])]),_:1}),e(R,null,{default:n(()=>[e(V,{icon:D(j(ie)),onClick:f},{default:n(()=>[w(" 创建 ")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"]),e(te),e(se,{columns:u,"data-source":l.value,pagination:!1,rowKey:"id",bordered:""},{bodyCell:n(({index:k,record:I,column:M})=>[M.key==="index"?(U(),T(q,{key:0},[w(G(k+1),1)],64)):B("",!0),M.key==="state"?(U(),A(ne,{key:1,color:I.state==="启用"?"success":"error"},{default:n(()=>[w(G(I.state),1)]),_:2},1032,["color"])):B("",!0),M.key==="operation"?(U(),A(oe,{key:2},{default:n(()=>[e(V,{type:"primary",size:"small",onClick:L=>y(I.id)},{default:n(()=>[w("详情")]),_:2},1032,["onClick"]),e(V,{type:"primary",size:"small",onClick:L=>z(I.id)},{default:n(()=>[w("编辑")]),_:2},1032,["onClick"]),e(le,{title:"确定要删除这个账号吗？","ok-text":"是的","cancel-text":"我再想想",onConfirm:L=>P(I.id)},{default:n(()=>[e(V,{type:"primary",size:"small"},{default:n(()=>[w("删除")]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)):B("",!0)]),_:1},8,["data-source"]),e(ue,{current:t.value.pageNum,"onUpdate:current":d[1]||(d[1]=k=>t.value.pageNum=k),"page-size":t.value.pageSize,"onUpdate:pageSize":d[2]||(d[2]=k=>t.value.pageSize=k),total:o.value,"onUpdate:total":d[3]||(d[3]=k=>o.value=k),"show-total":C,"show-size-changer":"",onChange:h,class:"pagination"},null,8,["current","page-size","total"]),e(ke,{modalVisible:v.value,onModalClose:b},null,8,["modalVisible"]),e(Oe,{modalVisible:m.value,userId:r.value,onModalClose:i},null,8,["modalVisible","userId"]),e(xe,{modalVisible:O.value,userId:r.value,onModalClose:$},null,8,["modalVisible","userId"])],64)}}});const Ne=ce(Ve,[["__scopeId","data-v-542a3f57"]]);export{Ne as default};
